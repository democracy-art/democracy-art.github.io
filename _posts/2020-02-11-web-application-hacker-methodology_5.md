---
layout:     post
title:      Web应用程序黑客的方法论(5)
subtitle:   
date:       2020-02-11
author:     D
header-img: 
catalog: true
mermaid: true
tags:
    - web hacking
---

Web应用程序黑客的方法论来自书本 *The Web Application Hacker's Handbook*


![Testing the management mechanism](/img/test-the-management-mechanism.png)

# 5.1 理解机制(Understand the Mechanism)

5.1.1<br>
分析用于管理会话和状态的机制.确定应用程序是否使用会话令牌或其他方法来处理从每个用户接收到的一系列请求.注意，有些身份验证技术(如HTTP身份验证)可能不需要完整的会话机制来重新识别身份验证后的用户.另外，一些应用程序使用无会话的状态机制，在这种机制中，所有状态信息都通过客户端传输，通常是加密的或模糊的形式.

5.1.2<br>
如果应用程序使用会话令牌，则精确地确定哪些数据片段实际用于重新标识用户.可以用来传输令牌的项包括HTTP cookie、查询字符串参数和隐藏的表单字段.几个不同的数据片段可能被用来重新识别用户，不同的项目可能被不同的后端组件使用.通常，看起来像会话标记的项实际上可能不会被应用程序采用，例如web服务器生成的默认cookie.

5.1.3<br>
要验证哪些项实际上是作为会话标记使用的，请查找与会话相关的页面或函数(例如特定于用户的My Details页面).然后向它发出几个请求，系统地排除您怀疑用作会话令牌的每个项.如果删除某个项会阻止返回与会话相关的页面，则可以确认该项是会话令牌.Burp `Repeater`是执行这些测试的有用工具.

5.1.4<br>
在确定哪些数据项实际用于重新标识用户之后，对于每个令牌，请确认它是否被完整地验证，或者是否忽略了令牌的某些子组件.每次更改令牌的值1字节，并检查修改后的值是否仍然被接受.如果您发现令牌的某些部分实际上并没有用于维护会话状态，那么您可以在进一步的分析中排除这些部分.

# 5.2 测试令牌的含义(Test Tokens for Meaning)

5.2.1<br>
在不同的时间作为几个不同的用户登录，并记录从服务器接收到的令牌.如果可以进行自注册，并且您可以选择自己的用户名，则使用一系列类似的用户名进行登录，这些用户名有一些小的变化，比如a、AA、AAA、AAAA、AAAB、AAAC、AABA等等.如果在登录时提交了其他特定于用户的数据或将其存储在用户配置文件中(例如电子邮件地址)，则执行类似的操作来系统地修改该数据并捕获生成的令牌.

5.2.2<br>
分析您接收到的令牌，看它们是否与用户名和其他用户可控制的数据相关.

5.2.3<br>
分析令牌是否有任何可检测的编码或混淆.查找用户名的长度和令牌的长度之间的相关性，这强烈地表明使用了某种混淆或编码.如果用户名包含相同字符的序列，则在令牌中查找对应的字符序列，这可能表示使用了XOR混淆.在标记中查找仅包含十六进制字符的序列，它可能表示ASCII字符串或其他信息的十六进制编码.查找以`=`和`/`或只包含其他有效Base64字符的序列:`a`到`z`、`A`到`Z`、`0`到`9`、`+`和`/`.

5.2.4<br>
如果您可以在会话令牌样本中识别出任何有意义的数据，那么请考虑这样是否足以发起攻击，尝试猜测最近向其他应用程序用户发出的令牌.找到一个依赖于会话的应用程序页面，并使用第14章中描述的技术自动生成和测试可能的令牌.

# 5.3 测试令牌的可预测性(Test Tokens for Predictability)

5.3.1<br>
使用能使服务器返回新令牌的请求(例如，一个成功的登录请求)，生成并连续捕获大量会话令牌.
<br>

[Web应用程序黑客的方法论(4)](https://dm116.github.io/2020/02/11/web-application-hacker-methodology_4/)<br>


